<html>
  <head>
    <title>Indexed DB Example</title>
    <script src="bower_components/webcomponentsjs/webcomponents.min.js"></script>
    <link rel="import" href="idb-node.html">
  </head>
  <body>
      <idb-node id="db" database="idb-node-sample" version="1" object-store="bookmarks" key-path="url"></idb-node>
      <template is="auto-binding" id="t">
        <table>
          <thead>
            <tr>
              <th>Title</th><th>Url</th>
            </tr>
          </thead>
          <tbody>
            <template repeat="{{row in table}}">
            <tr>
              <td>{{row.title}}</td><td>{{row.url}}</td>
            </tr>
            </template>
          </tbody>
        </table>
      </template>
    <script>
      var idb = document.querySelector('idb-node');
      idb.addEventListener('idb-ready', function() {
        console.log('database ready');

        document.querySelector('#t').addEventListener('template-bound', function() {
          var that = this;
          this.$.db.getAll().then(function(data) {
            that.table = data;
          });
        });

        // Bulk input of initial data
        idb.putBulk([
          {
            "title":"Expressions - Polymer",
            "url":"https://www.polymer-project.org/docs/polymer/expressions.html"
          },
          {
            "title":"Polymer core elements - Polymer",
            "url":"https://www.polymer-project.org/docs/elements/core-elements.html#core-collapse"
          },
          {
            "title":"FAQ - Polymer",
            "url":"https://www.polymer-project.org/resources/faq.html"
          },
          {
            "title":"core-icons",
            "url":"http://polymer.github.io/core-icons/components/core-icons/demo.html"
          },
          {
            "title":"Material design with Polymer - Polymer",
            "url":"https://www.polymer-project.org/docs/elements/material.html"
          },
          {
            "title":"Tender Surrender",
            "url":"http://localhost:8000/"
          },
          {
            "title":"Chrome ウェブストア - アプリ",
            "url":"https://chrome.google.com/webstore/detail/project-tab-manager/iapdnheekciiecjijobcglkcgeckpoia"
          },
          {
            "title":"App Structure | Android Developers",
            "url":"https://developer.android.com/design/patterns/app-structure.html"
          }
        ]).then(function() {
          console.log('initial data saved');
        });

        // Getting data
        idb.get('https://www.polymer-project.org/docs/elements/material.html').then(function(item) {
          console.log('got data with a key of "https://www.polymer-project.org/docs/elements/material.html"', item);
        });

      });
    </script>
  </body>
</html>
